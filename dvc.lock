schema: '2.0'
stages:
  prepare:
    cmd: python src/steps/prepare.py data/raw/ data/prepared
    deps:
    - path: data/raw
      hash: md5
      md5: ed7dbcbdabddccca552e276f80fa29ad.dir
      size: 120753872
      nfiles: 3
    - path: src/steps/prepare.py
      hash: md5
      md5: 6be9b5ade623ae30f074e32238d7b651
      size: 7113
    outs:
    - path: data/prepared
      hash: md5
      md5: 55220603c366d03cde8abbb5bb2f83a4.dir
      size: 51432579
      nfiles: 1
  train:
    cmd: python src/steps/train.py data/split/train.csv data/split/test.csv
    deps:
    - path: data/split/test.csv
      hash: md5
      md5: 57720f02a3b205618ec3022f30ab78ab
      size: 801084
    - path: data/split/train.csv
      hash: md5
      md5: 5985e0a23669913f60a4510d4b3e6ae2
      size: 1868191
    - path: src/steps/train.py
      hash: md5
      md5: 53c62a5d4e63ee6eddeb0ffefaaad2f8
      size: 1570
    outs:
    - path: data/models
      hash: md5
      md5: 786a8de8ebbc063ed6855b492d410e13.dir
      size: 110520530
      nfiles: 1
  evaluate:
    cmd: python src/steps/evaluate.py data/split/test.csv data/prepared/preprocessed.csv
    deps:
    - path: data/models
      hash: md5
      md5: 84206f4d472ae0109d6643a72f38059b.dir
      size: 128813724
      nfiles: 4
    - path: data/prepared/preprocessed.csv
      hash: md5
      md5: 079954d1d68d9d9a93dd174e9e5481d8
      size: 51048735
    - path: data/split/test.csv
      hash: md5
      md5: 77165b7fc0eeb0972e924f30f36837a2
      size: 1989088
    - path: src/steps/evaluate.py
      hash: md5
      md5: 617d803982ca4ad6b72e11a1077eec6f
      size: 2074
    outs:
    - path: data/eval/metrics.json
      hash: md5
      md5: f8c0d12ab0141af909587b5de56415ce
      size: 1425
  split:
    cmd: python src/steps/split.py data/prepared/ data/split
    deps:
    - path: data/prepared
      hash: md5
      md5: 55220603c366d03cde8abbb5bb2f83a4.dir
      size: 51432579
      nfiles: 1
    - path: src/steps/prepare.py
      hash: md5
      md5: 6be9b5ade623ae30f074e32238d7b651
      size: 7113
    outs:
    - path: data/split
      hash: md5
      md5: 9ca360f8b2beec63f0e0098996eb2db6.dir
      size: 3135160
      nfiles: 3
  train_baseline_model:
    cmd: python src/steps/train_baseline_model.py data/split
    deps:
    - path: data/split/train.csv
      hash: md5
      md5: c7b46f5416b7f3c36cb0ab68241b3c68
      size: 2204070
    - path: data/split/val.csv
      hash: md5
      md5: d2ab7b2d002788c3268ef4d3e71caedf
      size: 304035
    - path: src/steps/train_baseline_model.py
      hash: md5
      md5: 764b774a449978f3986b4d2f0310a5f6
      size: 312
    outs:
    - path: data/models/baseline
      hash: md5
      md5: faddcbd081d15ba6572f93ce6c70d18e.dir
      size: 3747
      nfiles: 1
  train_collaborative_filtering:
    cmd: python src/steps/train_collaborative_filtering.py data/split
    deps:
    - path: data/split/train.csv
      hash: md5
      md5: c7b46f5416b7f3c36cb0ab68241b3c68
      size: 2204070
    - path: data/split/val.csv
      hash: md5
      md5: d2ab7b2d002788c3268ef4d3e71caedf
      size: 304035
    - path: src/steps/train_collaborative_filtering.py
      hash: md5
      md5: ac74764d992ccd60d481ec750573bff3
      size: 292
    outs:
    - path: data/models/CollaborativeFiltering
      hash: md5
      md5: b083912541a16a56bce23273c6e42d1e.dir
      size: 7766163
      nfiles: 1
  train_factorization:
    cmd: python src/steps/train_factorization.py data/split
    deps:
    - path: data/split/train.csv
      hash: md5
      md5: c7b46f5416b7f3c36cb0ab68241b3c68
      size: 2204070
    - path: data/split/val.csv
      hash: md5
      md5: d2ab7b2d002788c3268ef4d3e71caedf
      size: 304035
    - path: src/steps/train_factorization.py
      hash: md5
      md5: 79608b660670120cfb681a1092e4b7bc
      size: 289
    outs:
    - path: data/models/MatrixFactorization
      hash: md5
      md5: 9225411c45e9ed8a198d0c79810fbe6b.dir
      size: 13239134
      nfiles: 1
  train_s_transformer:
    cmd: python src/steps/train_s_transformer.py data/split
    deps:
    - path: data/split/train.csv
      hash: md5
      md5: c7b46f5416b7f3c36cb0ab68241b3c68
      size: 2204070
    - path: data/split/val.csv
      hash: md5
      md5: d2ab7b2d002788c3268ef4d3e71caedf
      size: 304035
    - path: src/steps/train_s_transformer.py
      hash: md5
      md5: 7877b0f8c7efc57093733ac31df1c6f4
      size: 282
    outs:
    - path: data/models/STransformContentBase
      hash: md5
      md5: 5f26fbe97022226a935e6915fa1410ca.dir
      size: 93005250
      nfiles: 1
  train_hybrid_nn_model:
    cmd: python src/steps/train_hybrid_nn_model.py data/split
    deps:
    - path: data/split/train.csv
      hash: md5
      md5: c7b46f5416b7f3c36cb0ab68241b3c68
      size: 2204070
    - path: data/split/val.csv
      hash: md5
      md5: d2ab7b2d002788c3268ef4d3e71caedf
      size: 304035
    - path: src/steps/train_hybrid_nn_model.py
      hash: md5
      md5: c8a381c82eb90b516a2fc3be745b0aed
      size: 290
    params:
      params.yaml:
        book_column: ISBN
        filter_treshold: 100
        rating_column: Book-Rating
        train.min_delta: 0.001
        train.num_epochs: 1
        train.patience: 5
        train.test_file: test.csv
        train.train_file: train.csv
        train.val_file: val.csv
        user_column: User-ID
    outs:
    - path: data/models/HybridNNmodel
      hash: md5
      md5: ea14ef039497027f7ace7a9ab4a868d4.dir
      size: 112369100
      nfiles: 1
